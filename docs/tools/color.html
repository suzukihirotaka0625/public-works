<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>my skills</title>
    <link rel="shortcut icon" href="../favicon.ico" /> 
    <link rel="stylesheet" href="../assets/css/main.css" />
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/custom_elements.js" defer></script>
    <style>
      section:not(:first-of-type) + section {
        margin-top: 2rem;
      }
      h3 + div {
        display: flex;
        gap: .75rem 1.5rem;
        input {
          flex-grow: 1;
        }
      }
      .color {
        width: 30px;
        height: 30px;
        border: 1px solid #999;
        border-radius: 50%;
      }
      @media screen and (max-width: 640px) {
        h3 + div {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <my-header>
      <my-menu slot="menu"></my-menu>
    </my-header>
    <main>
      <div class="content">
        <section>
          <page-list></page-list>
        </section>
        <section>
          <h3>16進数 -> 10進数</h3>
          <div>
            <input id="c1_in" placeholder="#FF9966"/> <button id="c1_btn">変換</button> <input id="c1_out" /> <div class="color" />
          </div>
        </section>
        <section>
          <h3>10進数 -> 16進数</h3>
          <div>
            <input id="c2_in" placeholder="255 218 27"/> <button id="c2_btn">変換</button> <input id="c2_out" /> <div class="color" />
          </div>
        </section>
        <section>
          <h3>10進数 + 透明度 -> 10進数</h3>
          <div>
            <input id="c3_in" placeholder="255 218 27 / 0.2" /> <button id="c3_btn">変換</button> <input id="c3_out" /> <div class="color" />
          </div>
        </section>
      </div>
    </main>
    <script>
      window.addEventListener('DOMContentLoaded', (event) => {

        // 16進数 -> 10進数
        const c1Out = document.getElementById('c1_out')
        document.getElementById('c1_btn').addEventListener('click', () => {
          let inputValue = document.getElementById('c1_in').value.replace('#', '')
          if (!/^[\da-fA-F]+$/.test(inputValue)) return
          if (![3, 6].includes(inputValue.length)) return
          inputValue = inputValue.length === 3 ? inputValue.replace(/(.)(.)(.)/, '$1$1$2$2$3$3') : inputValue

          const outputValue = inputValue.match(/.{2}/g).map(v => parseInt(v, 16)).join(' ')
          c1Out.value = outputValue
          c1Out.nextElementSibling.style.background = `#${inputValue}`
        })

        // 10進数 -> 16進数
        const c2Out = document.getElementById('c2_out')
        document.getElementById('c2_btn').addEventListener('click', () => {
          let inputValue = document.getElementById('c2_in').value.replace(/\s+/g, ' ')
          if (!/^\d{1,3}( \d{1,3})*$/.test(inputValue)) return
          const colors = inputValue.split(' ').map(v => Number(v))
          if (colors.length !== 3 || colors.some(c => c < 0 || c > 255)) return
          const outputValue = colors.map(v => v.toString(16)).join('')
          c2Out.value = `#${outputValue}`
          c2Out.nextElementSibling.style.background = c2Out.value
        })

        // 10進数 + 透明度 -> 10進数
        const c3Out = document.getElementById('c3_out')
        document.getElementById('c3_btn').addEventListener('click', () => {
          let inputValue = document.getElementById('c3_in').value.replace(/\s+/g, ' ')
          if (!/^\d{1,3}( \d{1,3}){2} ?\/ ?0?\.\d+$/.test(inputValue)) return
          const colors = inputValue.replace(/ ?\/ ?/, ' ').split(' ').map(v => Number(v.startsWith('.') ? `0${v}` : v))
          if (colors.length > 4) return
          const opacity = colors.pop()
          if ( colors.some(c => c < 0 || c > 255)) return
          if (opacity < 0 || opacity >= 1) return

          const outputValue = colors.map(c => Math.round(c + (255 - c) * (1 - opacity))).join(' ')
          c3Out.value = outputValue
          c3Out.nextElementSibling.style.background = `rgb(${outputValue})`
        })
      })
    </script>
  </body>
</html>